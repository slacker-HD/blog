---
title: CREO Toolkit二次开发-绘图与视图
tags:
  - CREO
  - TOOLKIT
  - CREO二次开发
comments: true
category: CREO二次开发
date:
---




在工程图中插入二维码可以方便机器扫描读取，易于将图纸与MES、ERP等系统结合。添加二维码一般可以考虑以下方式：

1. 在工程图中插入图片等OLE内容。可以在Creo中导入外部程序生成的诸如jpg、png等图片格式的二维码文件。经测试，插入OLE内容暂时不仅未提供Toolkit接口，并且录制宏发现插入图片的操作也无法通过宏的方式实现，所以该方法只能由设计人员手动添加，无法进行二次开发。
2. 在工程图中插入dxf。可以在Creo中导入外部程序生成的dxf格式的二维码文件。经测试，导入的dxf文件会转换为草绘对象，而且Toolkit提供了Pro2dImportAppend函数用于导入dxf文件，所以该方法不仅可以手动操作，也适合于二次开发。但该方法导入dxf后添加了一系列草绘图元，当需要修改时难以确定那些草绘时导入的dxf文件转换得到导致难以对二维码相关的草绘删除修改，故该方法仅适用于一次性导入二维码的操作。
3. 生成包含二维码信息的符号。可以在绘图中添加一个符号，在符号中绘制对应的二维码图案，之后插入该符号。该方法手工操作较复杂，主要需要手动绘制对应的二维码符号，但易于插入修改及替换，而Toolkit也提供了绘制符号的方式。