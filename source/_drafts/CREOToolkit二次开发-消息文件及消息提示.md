---
title: CREOToolkit二次开发-消息文件及消息提示
tags:
  - CREO
  - TOOLKIT
  - CREO二次开发
comments: true
category: CREO二次开发
date:
---

消息文件为于菜单、以及一些提示信息提供文本内容，本文介绍消息文件的组成及如何使用消息文件读取、显示消息。

## 1.消息文件

### 1.1 消息文件的基础格式

消息文件其实是一个文本文件，保存在二次开发的程序注册文件(protk.dat)中以text_dir语句命名的目录或当前Creo工作目录。

消息文件记录了所有当前Toolkit程序需要用的消息。每一条消息由四行组成，其中：

> 第一行是标识消息的关键字的字符串，唯一，程序通过这行内容寻找消息的内容。
> 第二行记录了消息显示的内容，通过修改消息文件中的这一行，您可以在不修改C代码的情况下修改消息的文本，一般用英文，当然作为中文用户使用中文也没有问题，这样默认英文环境下也显示中文。
> 第三行记录了消息的翻译信息，我们自然是使用中文，这样如果Creo配置环境为中文则显示该行信息。
>	有意为将来的扩展保留的空白行,一般直接使用#号即可。

### 1.2 消息文件的前缀

消息文件的第一行可以使用前缀设置对应的图标，对应说明如下：

| 前缀 | 类型     | 说明                                              |
| ---- | -------- | ------------------------------------------------- |
| %CP  | Prompt   | 提示，提示信息前面添加一个绿色的箭头。            |
| %CI  | Info     | 信息，提示信息前面添加一个蓝色的点。              |
| %CW  | Warning  | 警告，提示信息前面添加一个包含感叹号的三角形。    |
| %CE  | Error    | 错误，提示信息前面添加一个破碎绿色+黄色的正方形。 |
| %CC  | Critical | 严重错误，提示信息前面添加一个红色的×。           |

**注意：Toolkit函数在查找消息时，前缀是默认忽略的，在代码中须删除对应的前缀才能查找到消息。**


### 1.3 格式化字符串

•转换规范(%d， %s，等等)必须包含一个参数编号，对应于该参数在后续列表中的位置(从0开始)。例如，不是%d， %s，而是%0d，%1，等等。如果你想指定一个字段宽度，把它放在位置号和类型说明符之间的圆括号中;例如,% 0 f(5.3)。



| Conversion Character | Data Type                                   | 说明                                   |
| -------------------- | ------------------------------------------- | -------------------------------------- |
| f                    | Float (or double)                           | 浮点型数据并且可以指定格式，如(5.3)f等 |
| d                    | Decimal integer                             | 十进制整数                             |
| s                    | Ordinary string (or type char[])            | 普通字符串（chars数组）                |
| w                    | Wide character strings                      | wchar_t数组                            |
| e                    | Exponential                                 | 指数形式数字，形如2.3e3                |
| g                    | Either float or exponential, as appropriate | 浮点或指数形式的数字均可               |

### 1.4 消息输入的默认值




**P.S.消息文件只在会话期间加载到Creo参数中一次，二次开发时如果在程序运行时对消息文件进行更改，则必须重新启动Creo才能使更改生效。**

## 2.消息文件的使用

### 2.1 在消息提示区显示消息

### 2.2 清除消息提示区消息

### 2.3 读取消息

